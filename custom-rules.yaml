rules:
  - id: typescript.security.eval
    languages: [typescript, javascript]
    message: Avoid using eval() as it can execute arbitrary code
    severity: ERROR
    patterns:
      - pattern: eval($X)

  - id: typescript.security.innerhtml
    languages: [typescript, javascript]
    message: Setting innerHTML with user input can lead to XSS vulnerabilities
    severity: ERROR
    patterns:
      - pattern: $E.innerHTML = $X

  - id: typescript.security.exec
    languages: [typescript, javascript]
    message: Avoid using exec() as it can execute arbitrary commands
    severity: ERROR
    patterns:
      - pattern: exec($X)

  - id: typescript.security.console
    languages: [typescript, javascript]
    message: Remove console statements in production code
    severity: WARNING
    patterns:
      - pattern: console.$METHOD($X)
      - metavariable-regex:
          metavariable: $METHOD
          regex: "^(log|warn|error|debug|info)$"

